#include <catch2/catch.hpp>

#include <spaceimage.h>

#include <iostream>

using namespace AdventOfCode;

TEST_CASE("two layers") {
  Format data{1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2};
  SpaceImage reference(3, 2, data);

  SpaceImage image =
      SpaceImage::fromDigitalSendingNetwork(3, 2, "123456789012");

  REQUIRE(image == reference);
}

void printImage(int width, int height, ImageLayer image) {
  for (int y = 0; y < height; ++y) {
    for (int x = 0; x < width; ++x) {
      if (image[width * y + x] == 1)
        std::cout << '1';
      else
        std::cout << ' ';
    }
    std::cout << '\n';
  }
}

TEST_CASE("Image") {
  SpaceImage image =
      SpaceImage::fromDigitalSendingNetwork(2, 2, "0222112222120000");

  printImage(2, 2, image.finalImage ());
}

TEST_CASE("AOC8") {
  std::string imageData =
      "222220022222222021202222022220222221022222222120222220222222122222222221"
      "122222220222222202222222222220220120222222222212202202222202222222220122"
      "222222222222222222222022202222122221222222022222222121222220222222022222"
      "222222222222221222222222222222222221221120222222222202212222222212222222"
      "220022222222222222022222222211212222122220222222022222222120222220222222"
      "222222222220122222221222222212222222222220220020222222222212202222222212"
      "222222120022222222222220122222222201202222222221222222022222222200222221"
      "222222122222222220222222201222222212222222221222221220222222222202212222"
      "222202222222021020222222222222122222212121222222022220222221022222222220"
      "222221222222222222222222022222200222222222222222222220222121222222222212"
      "222202222222222222202022222222222221122222222001212222022222222222122222"
      "222002222222222222122222222220022222221222222212222222222220221121222222"
      "222222222212222022222222122121222222222222222222212011202222222221222220"
      "022222022220222222222222122222222221122222022222222212222222220221220020"
      "222222222212202212222202222222221022222222222221222222212002222222222221"
      "222221122222222201222222222222022222222220122222222222222202222222222222"
      "222222222222222202212202222102222222202222222222222221022222222102212222"
      "022221222220022222022212222222222222222222222222022222020222222212222222"
      "220221220120222222222202202222222122222222200021222222222222222222212110"
      "212222022221222222222222022202222222222222222222222210222222211222222222"
      "222222221221221222222222222222222212222002222222002220222222222222222222"
      "222120222222022220222221122022222200222220222222122222222212122222100222"
      "222212222222220220220220222222222202202202222022222222120020222222122221"
      "022222222021202222222222222222022022122000222221222222022222222220022222"
      "112222222202222222220220220021222222222202212202222112222222100121222222"
      "222221222222212210202222222221222221122222022122222221222222122222222200"
      "122222202222222212222222220221222020222222222222212222222012222222102022"
      "222222222222022222212111212222022222222222022122022100222220222222222222"
      "222221022222202222222222222222220221220121222222222202222202222212222222"
      "011021222222222220222222212021222222112221222222222122122012222222222222"
      "222222222201222122201222222222222222220222222222222222222202212222222122"
      "222222122220222222222221122222222010222222012220222222122022022121222222"
      "222222022222222211022122102222222212222222221221220121222222222212222212"
      "222222222222110021222222022221222222222002222222202221222220122122022010"
      "222220222222022222222221122122222222222222222222221222221122222222222212"
      "202202222012122222012220222222022221222222212000222221022221222221122222"
      "122211222221222222222222222201022222112222222212222222222221220020222222"
      "220212222122222202022222202020222222222221122222222010212220002220222220"
      "222122022122222221222222022222222221122022220222222222222222222220220122"
      "222222221222222112222002022222020022222222122221222222222001212220222222"
      "222221022222122221222220222222022222222201022122001222222222222222222222"
      "222022222222220222212022222222022222102122222222022220022222222212222220"
      "102201222221222222222012222222222222122222222221122222221222222212222222"
      "220222220020222222221212202222222122122222101122222222122220022222202220"
      "212221002221222221022022022101222220202222022222222211022022012222222212"
      "222222222221222221222222222202102222222022022222121222222222022221222222"
      "202222202221202221222221222222122201222222202222222222222200222022012222"
      "222202222222222220221121222222220202002022222102122222121020222222122022"
      "222222202212212221212220202221122112022200222220222222022222222222122122"
      "000222222222222222220222220220222222221202122202222112022222200122222222"
      "222020122222212002202220212222222221222012122011222220222222122222222201"
      "022022122222222202222222220221222120222222222222212222222122122222212221"
      "222222222120222222202100212222112201222220222002022112222220212222022222"
      "222202022122211222222212222222222222221222222222221202002222222102122222"
      "210220222222122221122222212210212221112211222222022002222012222222212222"
      "222222222211122222212222222212222222221220220020222222220212102002222102"
      "122222001020222222022122222222222000212222212202222222222102222102222220"
      "202222022222222211122120111222222222222222220221222120222222222202202012"
      "222102222222202120222222122222122222212121212220022200222220122122122012"
      "222222222222222222222222022100002222222202222222221221222020222222222222"
      "102002222112222222120021222222122221122222222121222220002210222220222212"
      "222100222222202222022222222201122012001222222212220222221220222021222222"
      "222002002112222022222222210121222222222122022222202200002221002212212221"
      "022202222100222220202222222222222201022211210222222222222222221211221221"
      "222222220222002012222012222222012120222222222022222221212001102220122212"
      "212222022122122211222220212222022222222200022010100222222202220222222221"
      "220122222222220212202022222102222222101221222222122120222221222012112221"
      "002221212220122102022022222220220222222222222221122001111222222212220222"
      "222212220122222222220222022222222122022222012221222222222221222222202212"
      "022221112212202222222122222021222221211222122222222220022111200222222212"
      "222222220220220222222222221102202002222022022222211022222222122121022221"
      "202100122221002202222221022212022120222221210222022222222200222120102222"
      "222202222222221202222222222222220022202212222202222222022221222220022220"
      "022221222110202221102211212120022122222102222220222222122222222222222110"
      "011222222212222222222211221020222222220202102002222112122222100122222222"
      "022220222222200102002222212200212120122012022000222222212222022222222211"
      "022022222222222222222222222221221100222222222212202122222012022222222021"
      "222220122020122221200100002222022210202021022202222222222220210222122222"
      "222200022002222222222212222222222221220201222222221222222222222002122222"
      "110122222220222021222220102002122221112202222021222002022020222222212222"
      "222222222201022210111222222202222222222222221122222222222002102012222202"
      "222222201020222221122122222222011012222222212221202122122002222111222221"
      "220222022222222201022212201222222202222222221202221011222222210202012222"
      "222022020222111222222222122220122220002102202222102210202022222212022111"
      "222221210222022222222202022010212222222222220222220220221212222222212012"
      "202022222221022222022022222221122122222220012010012222002200222121122012"
      "122120222220211222022221222200222222210222222212222222220202222111222222"
      "210102112022212021122222100122222221122120022220211000012222112211222120"
      "022102222001222202202222222222222211022121102222222212222222222212220021"
      "222222222102012002202200220222001020222222222120122222101001222222022202"
      "212221122222222212222201200222122221222201222000220222222212222222221222"
      "221111222222222102202012202112220222122220222220022121122220022221022221"
      "102211202021022102022000222210222222222221222210022002211222222212220222"
      "220202222001222222200112112102202110020222101220222220122020022221212101"
      "122221222211212220222212122102222212212222022220222201222210001202222202"
      "222222221211222220222222220112122002202221220222102120222221022222222220"
      "021110202221212201202221002022222221222212201222122221222200022110221222"
      "222202221222220210221020222222202112202002222001120222201121222222222121"
      "122222220122202221002222212121122022022020222200220222022222222220222001"
      "110222222212221222222210221102222222211102122222202211220222202222222222"
      "222220222221220200202222012200212022102222022112222212220222022220222210"
      "122011211202222202220222222200221220222222210102022012222002220222022022"
      "222221122022222221011221222220022201222122112022122120222200211222222220"
      "222202022000110212222202222222221202222210221222210202202212202201121222"
      "221221222220022122222222002120012220202220202122122002022102222200202222"
      "022221222212222100120212222202222222201222221222221222200102202122202012"
      "021222110022222222222121122222100121222202022210212020002202022101222210"
      "221222122221222200122200020222222222220222211210220000222222221212212012"
      "202211120212201220222221222021122221000210102211122222222222002212022002"
      "222212222222022220220200222020002222222202222222202211220120220222211112"
      "012212212211121202221021222221122120022221100200022221112211212121112202"
      "122200222202201222122220222211122000211202222222221222212222220110220222"
      "210102222112212000121202211121222222122021122221002220211210012221202120"
      "112112122112222211212222222220220202122000121212222212221222211210220001"
      "222222200022202012222222020202100120022222222222022220221022102202002211"
      "202122102022122122222221221222022220221201022002201212222202221222222210"
      "221002221222201122012112212220222202112222212220222120122221102220011201"
      "112201202122000102222212222211210222222220220212022121201202022222222222"
      "202210222111221222221022022222212212120202021222202220122120122220121002"
      "000222212202222120121222222211222222221222122222220222022012121212022212"
      "220222201220220112221222212012012102202010120212011221212220022120122220"
      "121201221002002200222021221222022001222212201222122221201210122112111222"
      "122222221222221212221220222222212102212222212201021202101222102221022220"
      "022222212211012112012221202220120202022120222200212022022222220222022000"
      "112222122212222222222201220200221222222202002212202110022222012220012221"
      "122121022221001122221011012201212020012202222100222212202122022222202200"
      "220101102202122222221222210220221222222222212102022102212210222202020020"
      "222222222220222220112020200011122212212020120002122001222201200222022220"
      "211210222222122222022212220222222211221002221222221222022212212102020222"
      "000221012221122022122222020220110000002220222121111022122201222221211022"
      "022221201222221221201212122212222222212221221200222222210012202122222212"
      "120222021222112220122220222222020001102122102211212222021002222010222221"
      "200022122220212221221200110202122212220222201201221201221222202002002212"
      "122111022222212022202221122020221221121100100022022202212121222112222010"
      "222202021022122220220212020112121212222212221222200200220012222222200112"
      "012212202121222202220221002220022122121221212100022220202211222022011212"
      "222010221221220222122222200211221121001222122212221222201210221120220222"
      "200112022022222110221222101222112222122022120222222111002220002202222202"
      "000112222112121202120222122222220010020221010202122212222222202201222020"
      "221222012012212112102220021212210022112222222220020220212122222102202222"
      "202100202112122021120212012222122221220111220122020212122202220222212221"
      "221202222222212102112002212122121202010021122222222121220220022012120222"
      "122212212202111002122212222212002222022222201111021222100202222222222222"
      "212202221120222222110212012022122120122112002220120221122120221220221220"
      "222011112202212112122022222002202201210122122221210010221202101222122212"
      "221222212202220011222222012202222102022010021122122120102222222120221222"
      "122121101001012022202121001122022200111200212122222200222200020122002202"
      "222202221222211222220202220202220122202222222112020222211122020220022121"
      "222221100010202111122211212012102102222211002210012022122202211210120002"
      "221202022202221022210212221021220212010012110112222010122012120021111220"
      "122022021222010202220222112020212221112112022221211220220122222220221011"
      "122111021222222202221222221212221002221202201122202112002120020002012022"
      "110022222020222220111010101001122222222100022122022020001210212122022201"
      "210200121010011202022202220222222211222120220202220002100102002111222212"
      "001122021222122220121220110020001221102221202000212222122002102210202122"
      "222211220212021002012222122212220222210210221111220212100122111222012102"
      "022222210122200122122120221222010110020111002001222212201012122011201200"
      "120122022222201100220010212222122202221022212210220022222212220202110212"
      "022022101212101021201120022222021221202212211121012202202220020122222221"
      "112221121022122210202210221000002222222212221222221202222112220202222112"
      "001012112022122022202122010122122020122220222001111220222122202220111122"
      "222010221212211122022212222202221112202202122212221122212222221022201202"
      "202202100002122021221002211021000220122220022221221021112011112012222020"
      "020022222110121211001222122220202112220221212212222202222222201202222000"
      "220212221012100202102111111212120222212220222220121220001011120110212110"
      "202101020102022010100212202022122012211211221221122202122202221202210201"
      "221000222212010112100222112202021012210220020022122022022221110010211100"
      "222011212201112002022022112220212222222100220220010021021202022222220202"
      "201202222001222222222002022112022110100012211122000120222220120020010111"
      "200020212001222000020222222222220200102222022122200222110110211212022222"
      "221202221202220011211222010122001112122022012012010122002021222122020020"
      "221211200120212110202211202002222222122210101122022020200001020022211212"
      "022202220122222210220120221222120022220002212010122011010220021222022021"
      "122222002100202022112112222002100222222010010200122222122001212121210122"
      "112202122222221222210200220112102222001002121222122010010000021122021221"
      "222120121220211200100012012011212012201202122102102220220122022011201120"
      "021011020212222202222201010200222201010212211212012122202112002220010120"
      "211020222021120020110201011012202202212122120022022121202201021222022001"
      "202120222111022212122222220212111222220011010212022020122102212120100022"
      "221220022022022221021121100110021020212001222210210112122210022212100022"
      "022100220020121011022222122212221002011211201022122202210011200122212201"
      "122122101221020121222121222021222100100100122100212101111112222102111212"
      "122122122201200020211021120222222222221012110010201200010202110212120202"
      "222021000101202012111122022021222122100122020102002022212220221122122101"
      "012210221222222021220101022200010222022202222122022000200210122222012220"
      "220222012220100022002102201021122220122220111011001012212101212012100112"
      "222202102210020222022002210211010101112012022202221221001121201211102222"
      "122020120212202220022002021012211220122222221021000120202200022100212001"
      "022222122111211201210122122021200220010010212022222212222220021100211020"
      "200202221112021102002211001111022211002021122221222121211211011212012122"
      "212200210212022112210210112222022212201120220120210002222222222212010002"
      "202200010222021102220222202110112022021212220222222022121221122210020212"
      "102012202120101002122011022212001122222211222000101012000112222222222021"
      "222202210110122212212022221002112122201202202010110120022022122122211120"
      "220211022121202220210222122110100200000222122122221012222001102022220222"
      "220201021000222100002222111101102012122121012212222111002022022220022221"
      "120011021002112011222211222202122202222201201022222202222211001222022201"
      "220202221211210101211121210212122110020212012222102120211200012221022222"
      "020110202221101120212111222111100002222202111200112022022000221020022021"
      "201022021212221221212122202200210222100101112022012001020002200021210020"
      "122222220200222101100202212221222021110202122100221201110122022200201221"
      "012111222120122202221110010222212000122222021212210122102212221102102002"
      "102121022122020010211000200021002021202212100002122021001200211022122000"
      "220120112102201111120202222210012210220220002212110121100012112012221002"
      "210012020122022122020002120011020020022010222101200202120210122211211222"
      "222220202120122212101021220202220012020222221012012202110011102202102202"
      "101110022122121220100202110111101201210201000112000211022120012211122021"
      "011110111021021012010022012110111020100121202010020110222010021121200021"
      "201221112111122220020111";

  SpaceImage image = SpaceImage::fromDigitalSendingNetwork(25, 6, imageData);
  int expected = 1792;

  REQUIRE(expected == image.checksum());

  auto final = image.finalImage();
  printImage (25, 6, final);
}